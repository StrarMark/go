### MAC 地址概述

主机与路由器都具有链路层地址（MAC 地址），但是并不是主机与路由器本身具有链路层地址，而是它们的适配器（网卡）具有链路层地址。具有多个网络接口的主机或路由器将具有与之相关联的多个链路层地址。

MAC 地址长度为 6 字节，通常用十六进制形式表示，没有两个适配器具有相同的 MAC 地址，无论适配器到哪里都不会发生变化。

当某个适配器要向某些目的的适配器发送数据帧时，发送适配器将目的适配器的 MAC 地址插入到该帧中，并将该帧发送到局域网上。一台交换机偶尔将一个帧广播到它的所有接口，这样当一个适配器接收到一个帧时，将检查该帧中的目的 MAC 地址是否与自己的 MAC 地址匹配。如果匹配，该适配器提取出封装的数据，将该数据报向上协议栈传递。如果不匹配，则丢弃该帧。

### ARP 概述

ARP（address resolution protocol）用于网络层地址与链路层地址之间的转换。ARP 将一个 IP 地址解析为一个 MAC 地址。好像与 DNS 类似，但是却有很大的不同。DNS 可以在因特网任何地方解析主机名，而 ARP 只为在同一个子网上的主机和路由器接口解析 IP 地址。

每台主机或路由器在其内存中都具有一个 ARP 表。这张表包含 IP 地址到 MAC 地址的映射关系。该表也包含了一个寿命值，指示了映射关系的有效市场时长。

如果发送方的 ARP 表中具有该目的节点的表项，这个过程是很简单的。如果不包含，发送方就需要使用 ARP 协议来解析这个地址。首先发送方构造一个 ARP 分组，一个 ARP 分组具有几个字段，包含发送和接收 IP 地址及 MAC 地址。ARP 查询分组和响应分组都具有相同的格式。ARP 查询分组的目的是询问子网上所有其他主机和路由器，以确定对应于要解析的 IP 地址的那个 MAC 地址。

查询 ARP 报文是在广播帧中发送的，响应报文在一个标准帧中发送。因此 ARP 是即插即用的，就是说一个 ARP 表是自动建立的，不需要系统管理员配置，与 DHCP 类似。